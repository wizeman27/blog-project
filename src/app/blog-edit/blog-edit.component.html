<h2 class="title">{{editMode ? 'Edit Post' : 'New Post'}}</h2>



<div class="blog-form">
  <mat-stepper [linear]=false #stepper>
    <mat-step [stepControl]="blogRequiredFields">
      <form [formGroup]="blogRequiredFields">
        <ng-template matStepLabel>Please fill out required fields</ng-template>
        <p>
          <mat-form-field appearance="fill" [style.width.px]="formFieldWidth">
            <mat-label>Title</mat-label>
            <input matInput type="text" placeholder="Pick a great title for your blog post!" formControlName="title"
              required>
          </mat-form-field>
        </p>
        <p>
          <mat-form-field appearance="fill" [style.width.px]="formFieldWidth">
            <mat-label>Description</mat-label>
            <textarea matInput type="text" rows="6"
              placeholder="A short description of the post, to be displayed on cards" formControlName="description"
              required></textarea>
          </mat-form-field>
        </p>
        <p>
          <mat-form-field appearance="fill" [style.width.px]="formFieldWidth">
            <mat-label>Url address</mat-label>
            <input matInput type="text" placeholder="Add an SEO friendly address (using kebab-case)"
              formControlName="address" required>
          </mat-form-field>
        </p>
        <p>
          <mat-form-field appearance="fill">
            <mat-label>Featured</mat-label>
            <mat-select formControlName="featured" required>
              <mat-option value="option">Yes</mat-option>
              <mat-option value="option">No</mat-option>
            </mat-select>
            <mat-hint align="start">Is this a featured blog?</mat-hint>
          </mat-form-field>
        </p>

        <div>
          <button mat-button matStepperNext>Next</button>
        </div>
      </form>
    </mat-step>
    <mat-step [stepControl]="blogText">
      <form [formGroup]="blogText">
        <ng-template matStepLabel>Add the main text here, in sections.</ng-template>

        <div formArrayName="sections">
          <div *ngFor="let section of sections.controls; let i=index" [formGroupName]="i">
            <p>
              <mat-form-field appearance="fill" [style.width.px]="formFieldWidth">
                <mat-label>Section title</mat-label>
                <input matInput type="text" placeholder="This is the section title, e.g. Introduction"
                  formControlName="sectionTitle">
              </mat-form-field>
            </p>
            <p>
              <mat-form-field appearance="fill" [style.width.px]="formFieldWidth">
                <mat-label>Section description</mat-label>
                <textarea matInput type="text" rows="6" placeholder="This is the main text"
                  formControlName="sectionDescription"></textarea>
              </mat-form-field>
            </p>
            <button mat-stroked-button color="accent" type="button" (click)="onRemoveSection(i)">Remove section</button>
          </div>

          <button mat-stroked-button color="primary" type="button" (click)="onAddSection()">Add section</button>
        </div>
        <hr>
        <div>
          <button mat-button matStepperPrevious>Back</button>
          <button mat-button matStepperNext>Next</button>
        </div>
      </form>
    </mat-step>



    <mat-step [stepControl]="blogOptionalFields">
      <form [formGroup]="blogOptionalFields">
        <ng-template matStepLabel>Please fill out optional fields</ng-template>



        <p>
          <mat-form-field appearance="fill" [style.width.px]="formFieldWidth">
            <mat-label>Image URL/path</mat-label>
            <input matInput type="text" placeholder="Add a hero image URL (will have a local upload button later)"
              formControlName="imagePath">
          </mat-form-field>
        </p>


        <div formArrayName="quotes">
          <div *ngFor="let quote of quotes.controls; let i=index" [formGroupName]="i">
            <p>
              <mat-form-field appearance="fill" [style.width.px]="formFieldWidth">
                <mat-label>Quote</mat-label>
                <input matInput type="text" placeholder="Add a quote to be highlighted from the blog."
                  formControlName="quoteText">
              </mat-form-field>
            </p>

            <button mat-stroked-button color="accent" type="button" (click)="onRemoveQuote(i)">Remove quote</button>
          </div>

          <button mat-stroked-button color="primary" type="button" (click)="onAddQuote()">Add quote</button>
        </div>


        <p>
          <mat-form-field appearance="fill">
            <mat-label>Category</mat-label>
            <mat-select formControlName="category" required>
              <mat-option value="option">Article</mat-option>
              <mat-option value="option">Short story</mat-option>
            </mat-select>
            <mat-hint align="start">Select a category</mat-hint>
          </mat-form-field>
        </p>
        <p>
          <mat-form-field class="chip-list" appearance="fill">
            <mat-label>Tags</mat-label>
            <mat-chip-grid #chipGrid aria-label="Enter tags" formControlName="tags">
              <mat-chip-row *ngFor="let tag of tags" (removed)="remove(tag)" [editable]="true"
                (edited)="edit(tag, $event)" [aria-description]="'press enter to edit ' + tag.name">
                {{tag.name}}
                <button matChipRemove [attr.aria-label]="'remove ' + tag.name">
                  <mat-icon>cancel</mat-icon>
                </button>
              </mat-chip-row>
              <input placeholder="Add tags..." [matChipInputFor]="chipGrid" [matChipInputAddOnBlur]="addOnBlur"
                (matChipInputTokenEnd)="add($event)" />
            </mat-chip-grid>
          </mat-form-field>
          <!-- We should add autocomplete here maybe? -->

        </p>

        <div>
          <button mat-button matStepperPrevious>Back</button>
          <button mat-button matStepperNext>Next</button>
        </div>
      </form>
    </mat-step>
    <mat-step [stepControl]="blogReview">
      <form [formGroup]="blogReview">
        <ng-template matStepLabel>Preview your post</ng-template>
        <mat-form-field appearance="fill">
          <mat-label>preview</mat-label>
          <input matInput formControlName="thirdCtrl" placeholder="let's display a preview of the info collected so far" required>
        </mat-form-field>
        <div class="blogform-buttons" (ngSubmit)="onSubmit()">
          <button type="submit" mat-raised-button color="primary">Publish</button>
          <button type="button" mat-raised-button color="primary" (click)="onSaveDraft()">Save as Draft</button>
          <button type="button" mat-raised-button color="accent" (click)="onCancel()">Cancel</button>
        </div>
        <div>
          <button mat-button matStepperPrevious>Back</button>
          <button mat-button matStepperNext>Next</button>
        </div>
      </form>
    </mat-step>
    <mat-step>
      <ng-template matStepLabel>Done</ng-template>
      <p>You are now done.</p>
      <div>
        <button mat-button matStepperPrevious>Back</button>
        <button mat-button (click)="stepper.reset()">Reset</button>
      </div>
    </mat-step>
  </mat-stepper>
</div>



